<% assigned_contact = @issue.contacts.try(:first)
   if !assigned_contact
     if (cf = IssueCustomField.find_by(name: 'Assigned Contact'))
       val = @issue.try(:custom_field_value, cf)
       assigned_contact = Contact.find_by(id: val.to_i) if val.present?
     end
   end %>
<% if assigned_contact %>
<script>
  $(function(){
    var attrs = $('.issue .attributes').first();
    if (!attrs.length) return;
    var targetDt = attrs.find('dt').filter(function(){
      return ($(this).text() || '').trim() === '<%= j l(:field_assigned_to) %>';
    }).first();
    if (!targetDt.length) return;
    var dd = targetDt.next('dd');
    if (!dd.length) return;
    dd.html('<%= j(contact_tag(assigned_contact, type: "plain")) %>');
  });
</script>
<% end %>
